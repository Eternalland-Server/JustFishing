
Functions:
  open: |-
    var.frame = 1;
    var.time = 490;
    var.screenID = 'fish';
    func.Function_Async_Execute('fishing');
  fishing: |-
    var.frame = var.frame + 1;
    var.path = func.String_Concat('hud/fish/', func.String_ToInt(var.frame), '.png');
    func.Component_Set('fishing', 'texture', var.path);
    (var.frame >= 3) ? { var.frame = 0 } : {};
    func.delay(800);
    func.Function_Async_Execute('fishing');
  pointer: |-
    var.start = func.Time_Current;
    func.Component_Set('pointer', 'x', 'track.x+30+15*(func.Time_Current - var.start)/var.time');
    func.delay(var.time);
    func.Component_Set('pointer', 'x', 'track.x+45');
  keyPress: |-
    var.current = func.Component_Get('pointer', 'x');
    var.goal_start = func.Component_Get('goal', 'x') - 5;
    var.goal_end = func.Component_Get('goal', 'width') + var.goal_start + 5;
    (func.Key_Get_Press == 'SPACE' && func.Screen_ChatGui_Get == '') ? { 
      (var.current > var.goal_start && var.current < var.goal_end) ? { 
          func.Packet_Send('UIFCompSubmitEvent', var.screenID, 'result', '1', var.current); 
        } : {
          func.Packet_Send('UIFCompSubmitEvent', var.screenID, 'result', '0', var.current);
        };
    } : {};


body:
  type: texture
  texture: 0,0,0,0
  x: (w-body.width)/2
  y: h-160
  width: 240
  height: 320

fishing:
  type: texture
  texture: hud/fish/1.png
  x: body.x+(body.width-fishing.width)/2
  y: background.y-20
  width: 45.5
  height: 13
  visible: icon.visible == 0

icon:
  type: texture
  texture: 0,0,0,0
  x: body.x+(body.width-icon.width)/2
  y: background.y-26
  width: 24
  height: 24
  visible: 0

background:
  type: texture
  texture: hud/fish/track.png
  x: body.x+(body.width-background.width)/2
  y: body.y
  width: 100
  height: 16

hint:
  type: texture
  texture: 0,0,0,0
  extends: background
  y: background.y+18
  text: '♑ 钓鱼'

track:
  type: texture
  texture: 0,0,0,0
  x: background.x+11
  y: background.y+4
  width: 79
  height: 8

goal:
  type: texture
  texture: hud/fish/target.png
  x: track.x+45
  y: track.y
  width: 10
  height: 8

pointer:
  type: texture
  texture: hud/fish/pointer.png
  x: track.x+30
  y: track.y-3
  width: 5
  height: 14
  visible: icon.visible == 0

result:
  type: texture
  texture: hud/fish/pointer.png
  x: track.x
  y: pointer.y
  width: 5
  height: 14
  visible: icon.visible == 1